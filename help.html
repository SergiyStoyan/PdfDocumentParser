<html>

<style>
h1 { text-align: center;}
h2 {color:#990022; text-indent: 20px; margin-top:50}
h3 {color:#0000aa; margin-top:40}
p {
    margin: 5;
    margin-top:5
    padding1: 0;
}
</style>




<head>
</head>
<body>
<h1>PdfDocumentParser Help</h1>
<h2>Overview</h2>
<p>PdfDocumentParser is inteded to extract text/images from pdf documents that have predefined graphic layout such as invoices and the like. The main approach of parsing is based on finding cetain text or image specimens in page and then extracting text from rectangle whose coordinates relate to them.
<p>Within this scope PdfDocumentParser exposes the following options:
<ul>
<li>pdf elements processing (the main way to operate with text in PdfDocumentParser);</li>
<li>OCR processing;</li>
<li>Image processing;</li>
</ul>
<p>PdfDocumentParser can process documents of different structures at the same time. 
<p>Every document type needs a template that contains information what info and how must be parsed from document.

<h2>Template</h2>
<p>When you want to parse a new type document, first create an empty template and open it. Select a pdf file that is to be parsed and when it is displayed in the editor you go the following steps:
<p>- create <a href="#floating_anchor">floating anchors</a>;
<p>- create <a href="#mark">document recognition marks</a>;
<p>- create <a href="#field">fields</a>;
<p>- selecting every created element check if it works as expected;
<p>- save template;


<h3><a name="floating_anchor">Floating Anchor</a></h3>
<p>Floating anchor is a speciming of either text or image that PdfDocumentParser will look in every page of a document. Then the found anchor is used to locate in the page Marks or/and Fields that are linked to it. While the only idea of floating anchors is detecting absolute coordinate points in page, it solves the several tasks:
<p>- finding marks/fields whose position in the page may vary e.g. for 'total amount' in the bottom of invoice table. 
<p>- recoginizing marks/fields which may be met only in one page of multypage document. If a field is not linked to a floating anchor then it will be extracted from every page and only the last value (which may be wrong) will be output;
<p>- detecting zero position in scanned documents because usually their margines vary;
<p>To create a Floating anchor, select a new row in the floating anchors table and then select with mouse a rectangle in the document page. The text ot image within the box will be that specimen that PdfDocumentParser will look for.
<p>Floating anchor can be 3 types:
<ul>
<li>pdf text - which is text presented as pdf char boxes;</li>
<li>OCR text - which is text recognized by OCR engine within the selected area;</li>
<li>Image data - which is hash of the image bounded by the selection box;</li>
</ul>
<p>Upon creating a floating anchor you can create either document recognition marks or fields and links them to it. Linking means that mark's or field's coordinates become relative to the floating anchor they are linked to. That's PdfDocumentParser first will look for the floating anchor and if it is found, it will locate mark or field depending on it's location.

<h3><a name="mark">Document Recognition Mark</a></h3>
<p>Document recognition mark is a speciming of either text or image that PdfDocumentParser will look in a document. One or more such marks is used by PdfDocumentParser to detect which tempate corresponds to the processed document. For this reason every template should have at least one document recognition mark defined. It is obviousely such marks must be unique enough to identhicate the document they belong with high confidence. It works the following way: PdfDocumentParser finds mark in page and compares found content with the stored mark content. 
<p>If all marks of a template are found in page then this template is chosen for further processing of all the pages of this document. 
<p>To create a document recognition mark, select a new row in the marks. Now, you have 3 options: 
<p>- link the mark to a floating anchor by chosing its ID and it may be enough: that means that PdfDocumentParser will look for the anchor and if it is found it will be considered as the document recoginition mark;
<p>- select with mouse a rectangle in the page whose content is unique for this document type. E.g. for invoice it will be a company name or logo printed in the top of page. If you are sure that this mark always is located in the same position in page then no need to link the mark to a floating anchor and it can be left as is. It this case it will work the following way: PdfDocumentParser locates mark's rectangle in page and compares its content with mark's content: when they are the same then the mark is considered found;
<p>- otherwise, usually when you parse scanned documents you have to link the mark to an anchor. It this case it will work the following way: PdfDocumentParser finds the anchor, then locate mark's rectangle relatively to the anchor and so on.

<h3><a name="field">Field</a></h3>
<p>Field defines cetain text that you want extract from document. Like with document recognition mark it can either be linked to an anchor or retain absolute position in page. 
<p>To create a field, select a new row in the fields table and select the area in page were text beloning to this field must be extracted. For conventinal pdf documents you shuld never use OCR option but for scanned documents it is the only way to get text in digital form that can be recorded in a file or database, indexed, searched and so on.

<h3>File Filter</h3>
<p>When file names can suggest which template is appropriate then yon can specify file filter in this tempate. It is regex expression applied to document path. Such filter will reduce processing time hugely;

<h2>Types of text/image operation</h2>
<p>PdfDocumentParser provides the following options to operate with text and images:
<ul>
<li>Extracting text by from pdf structure. This is way is based on native text presentation inside pdf files. It is the main way to operate with text in PdfDocumentParser as it is the most robust and fast.</li>
<li>Getting text from image by OCR technology provided by Tesseract engine incorporated into PdfDocumentParser. This option must be chosen only when pdf processing does not work. It usually happens when documents you  want to parse consist completely or partially of images such as scanned documents, photos etc. This way cannot not give 100% accuracy against pdf processing and will acceptably work only for images with resolution not less than 300dpi. Also this way is much slower.</li>
<li>Image comparison. This way is used for seeking and comparison images in documents. It is usually used in document detection marks but also can be used in floating anchors. This way is slower than pdf processing and so must be declined when possible. Also, it may not provide 100% accuracy on scanned documents if they have big discrepancy in quality such as size, contrast, brightness etc.</li>
</ul>

<h2>Scanned documents</h2>
<p>Scanned documents are not the first subject for PdfDocumentParser but they are supported on a basic level. Usually such documents need to be preprocessed before feeding them to OCR engine. Such preprocessing includes auto-deskew, image rotation options. 
<p>Because of quality deviations in scanned documents you may want to play with image comparison tolerancy paramters.
<p>Also, it is important to set image resolution in PdfDocumentParser not less than 300dpi, otherwise OCR will not work. On the other hand, increasing resolution increases processing time. Also, setting resolution in PdfDocumentParser higher than the resolution of original images will not make sense. Image resolutin paramter in common for all templates and can be changed in settings window. 


<h2>Considerations</h2>
<p>When processing documents PdfDocumentParser applies every active template to every new document to recognize the proper template. So, if you have 50 templates and 1000 files evenly distributed for templates, PdfDocumentParser will try on average 1000/2 *50 = 25,000 templates. It may take a considerable time especially with templates using OCR. You can decrease processing time the following ways:
<p>- keep templates that are not appropriate for files to be processed, inactive;
<p>- sort and separate files by templates so that PdfDocumentParser will try and choose not among 50 templates but only 5-10. 
<p>- specify file filters for tempates;
<p>A rule of thumb would be to process files which needs OCR separately and keep their templates inactive for the rest files.

<p>
<p style="text-align:center">
<a href="mailto:sergey.stoyan@gmail.com?Subject=PdfDocumentParser support request" target="_top">Support</a>

</body>
</html>